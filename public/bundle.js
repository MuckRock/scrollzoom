'use strict';var v=this;
function w(){function C(a){let b=!0;return()=>{b?b=!1:a()}}function x(a){let b=null;return(...c)=>{null!=b&&(cancelAnimationFrame(b),b=null);b=requestAnimationFrame(()=>{b=null;a(...c)})}}function D(a,b){let c=["resize",x(b)];window.addEventListener(...c);return()=>window.removeEventListener(...c)}function E(a,b){let c=new ResizeObserver(C(x(b)));c.observe(a);return()=>c.disconnect()}function F(a,b){return null!=window.ResizeObserver?E(a,b):D(a,b)}function y(){var a=new r(6);r!=Float32Array&&(a[1]=
0,a[2]=0,a[4]=0,a[5]=0);a[0]=1;a[3]=1;return a}function z(a,b,c){var d=b[1],e=b[2],f=b[3],h=b[4],p=b[5],l=c[0];c=c[1];a[0]=b[0]*l;a[1]=d*l;a[2]=e*c;a[3]=f*c;a[4]=h;a[5]=p;return a}function t(a,b,c){var d=b[0],e=b[1],f=b[2],h=b[3],p=b[4];b=b[5];var l=c[0];c=c[1];a[0]=d;a[1]=e;a[2]=f;a[3]=h;a[4]=d*l+f*c+p;a[5]=e*l+h*c+b;return a}function G(){var a=new r(2);r!=Float32Array&&(a[0]=0,a[1]=0);return a}function A(a,b,c){var d=b[0];b=b[1];a[0]=c[0]*d+c[2]*b+c[4];a[1]=c[1]*d+c[3]*b+c[5];return a}function u(a,
b,c=1E-6){return Math.abs(a-b)<c}class H{constructor(a,b,c=F){this.element=a;this.o=b;this.v(!0);c(a,()=>this.v())}v(a=!1){this.width=this.element.offsetWidth;this.height=this.element.offsetHeight;a||null==this.o||this.o(this.width,this.height)}}var r="undefined"!==typeof Float32Array?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var a=0,b=arguments.length;b--;)a+=arguments[b]*arguments[b];return Math.sqrt(a)});(function(){var a=G();return function(b,c,d,e,f,h){c||(c=2);d||(d=0);for(e=
e?Math.min(e*c+d,b.length):b.length;d<e;d+=c)a[0]=b[d],a[1]=b[d+1],f(a,a,h),b[d]=a[0],b[d+1]=a[1];return b}})();class I{constructor(a,b){this.a=y();this.i=null;this.m=b;this.viewport=a;this.s=!0;this.g=null}I(a){this.viewport=a}w(a){this.a=a;null!=this.i&&this.s&&this.i();null!=this.m&&this.m()}f(a){let b=[0,0];A(b,a,this.a);return b}u(a){let b=[0,0],c=y();var d=this.a,e=d[0],f=d[1],h=d[2],p=d[3],l=d[4];d=d[5];var k=e*p-f*h;k&&(k=1/k,c[0]=p*k,c[1]=-f*k,c[2]=-h*k,c[3]=e*k,c[4]=(h*d-p*l)*k,c[5]=(f*
l-e*d)*k);A(b,a,c);return b}scale(a,b,c){.2>this.a[0]*c?c=.2/this.a[0]:8<this.a[0]*c&&(c=8/this.a[0]);let [d,e]=this.u([a,b]);t(this.a,this.a,[d,e]);z(this.a,this.a,[c,c]);t(this.a,this.a,[-d,-e]);this.w(this.a)}D(a,b,c){let d=this.viewport.width,e=this.viewport.height;b=Math.min(d/b,e/c);c=y();t(c,c,[d/2,e/2]);z(c,c,[b,b]);t(c,c,[-a[0],-a[1]]);return c}C(a,b,c,d,e,f){c*=e;d*=f;this.w(this.D([a*e+c/2,b*f+d/2],c,d))}}class J{constructor(a,b,c,d,e){this.element=a;this.c=b;this.g=d;this.transform=e;
this.A();this.l=c[0];this.j=c[1];this.transform.g=[this.l,this.j];this.h=!1;this.B=[[["scroll"],()=>this.scroll()],[["wheel"],f=>this.K(f)]];this.G=x((f,h,p,l)=>{this.b={left:p,top:l,width:f,height:h};u(f,this.c.offsetWidth)&&u(h,this.c.offsetHeight)||(this.c.style.width=`${f}px`,this.c.style.height=`${h}px`);u(p,this.element.scrollLeft)&&u(l,this.b.scrollTop)||(this.h=!0,this.element.scrollLeft=p,this.h=!0,this.element.scrollTop=l)});this.transform.i=()=>this.H();this.B.forEach(f=>{f[0].forEach(h=>
{this.element.addEventListener(h,f[1],{passive:!1})})})}H(){let a=this.transform.f([0,0]),b=this.transform.f([this.l,this.j]);this.G(b[0]-a[0],b[1]-a[1],-a[0],-a[1],this.F);this.F=!1}scroll(){this.h?this.h=!1:(this.A(),this.J())}J(){let a=this.b.top/this.b.height,b=this.g.height/this.b.height,c=this.b.left/this.b.width,d=this.g.width/this.b.width;this.transform.s=!1;this.transform.C(c,a,d,b,this.l,this.j);this.transform.s=!0}K(a){if(a.ctrlKey){a.preventDefault();var b=this.element;var c=a.pageX;var d=
a.pageY,e=b.offsetLeft,f=b.offsetTop;for(b=b.offsetParent;b;)e+=b.offsetLeft,f+=b.offsetTop,b=b.offsetParent;c={x:c-e,y:d-f};let {x:h,y:p}=c,{deltaX:l,deltaY:k}=a;0==l&&0==k||this.transform.scale(h,p,Math.exp(.007*-k))}}A(){this.b={left:this.element.scrollLeft,top:this.element.scrollTop,width:this.c.scrollWidth,height:this.c.scrollHeight}}}return function(a,b={}){let c=new H(a),d=0,e=(b.components||[]).map(n=>({...n,id:d++})),f={},h=b.width||500,p=b.height||500,l=document.createElement("div");l.style.width=
`${h}px`;l.style.height=`${p}px`;l.style.position="relative";a.appendChild(l);let k=new I(c,()=>{for(var n=0;n<e.length;n++){var g=e[n],m=k.f([0,0]),q=k.f([g.x,g.y]);const B=k.f([g.x+g.width,g.y+g.height]);m={x:q[0]-m[0],y:q[1]-m[1],width:B[0]-q[0],height:B[1]-q[1]};null==f[g.id]?(m=g.component.render(m),f[g.id]=m,a.appendChild(m)):g.component.update(f[g.id],m)}n=b.debugCanvas;g=b.width;m=b.height;if(null!=n)for(n=n.getContext("2d"),n.clearRect(0,0,g,m),g=k.u([0,0]),m=k.u([c.width,c.height]),n.strokeRect(g[0],
g[1],m[0]-g[0],m[1]-g[1]),n.fillStyle="rgba(0, 0, 0, 0.02)",n.strokeRect(g[0],g[1],m[0]-g[0],m[1]-g[1]),g=0;g<e.length;g++)q=e[g],m=[q.x,q.y],q=[q.x+q.width,q.y+q.height],n.fillStyle="rgba(0, 0, 0, 0.08)",n.fillRect(m[0],m[1],q[0]-m[0],q[1]-m[1])});k.m();new J(a,l,[h,p],c,k);c.o=n=>k.I(n)}}"object"===typeof exports&&"undefined"!==typeof module?module.exports=w():"function"===typeof define&&define.L?define(w):(v=v||self,v.scrollzoom=w())
