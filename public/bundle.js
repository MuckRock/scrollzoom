'use strict';var v=this;
function w(){function D(a){let b=!0;return()=>{b?b=!1:a()}}function x(a){let b=null;return(...c)=>{null!=b&&(cancelAnimationFrame(b),b=null);b=requestAnimationFrame(()=>{b=null;a(...c)})}}function E(a,b){let c=["resize",x(b)];window.addEventListener(...c);return()=>window.removeEventListener(...c)}function F(a,b){let c=new ResizeObserver(D(x(b)));c.observe(a);return()=>c.disconnect()}function G(a,b){return null!=window.ResizeObserver?F(a,b):E(a,b)}function y(){var a=new u(6);u!=Float32Array&&(a[1]=
0,a[2]=0,a[4]=0,a[5]=0);a[0]=1;a[3]=1;return a}function z(a,b,c){var d=b[1],e=b[2],f=b[3],h=b[4],n=b[5],m=c[0];c=c[1];a[0]=b[0]*m;a[1]=d*m;a[2]=e*c;a[3]=f*c;a[4]=h;a[5]=n;return a}function t(a,b,c){var d=b[0],e=b[1],f=b[2],h=b[3],n=b[4];b=b[5];var m=c[0];c=c[1];a[0]=d;a[1]=e;a[2]=f;a[3]=h;a[4]=d*m+f*c+n;a[5]=e*m+h*c+b;return a}function H(){var a=new u(2);u!=Float32Array&&(a[0]=0,a[1]=0);return a}function A(a,b,c){var d=b[0];b=b[1];a[0]=c[0]*d+c[2]*b+c[4];a[1]=c[1]*d+c[3]*b+c[5];return a}function r(a,
b,c=1E-6){return Math.abs(a-b)<c}function B(a,b){var c=a.pageX;a=a.pageY;var d=b.offsetLeft,e=b.offsetTop;for(b=b.offsetParent;b;)d+=b.offsetLeft,e+=b.offsetTop,b=b.offsetParent;return{x:c-d,y:a-e}}class I{constructor(a,b,c=G){this.element=a;this.v=b;this.A(!0);c(a,()=>this.A())}A(a=!1){this.width=this.element.offsetWidth;this.height=this.element.offsetHeight;a||null==this.v||this.v(this.width,this.height)}}var u="undefined"!==typeof Float32Array?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var a=
0,b=arguments.length;b--;)a+=arguments[b]*arguments[b];return Math.sqrt(a)});(function(){var a=H();return function(b,c,d,e,f,h){c||(c=2);d||(d=0);for(e=e?Math.min(e*c+d,b.length):b.length;d<e;d+=c)a[0]=b[d],a[1]=b[d+1],f(a,a,h),b[d]=a[0],b[d+1]=a[1];return b}})();class J{constructor(a,b){this.a=y();this.o=null;this.s=b;this.viewport=a;this.w=!0;this.b=null}R(a){this.viewport=a}F(){if(null!=this.b){var a=0,b=0,[c,d]=this.h([0,0]),[e,f]=this.h(this.b[0]),h=this.b[1][0],n=this.b[1][1];e-c<h&&(0>c?a=
c:e>h&&(a=e-h));f-d<n?0>d?b=d:f>n&&(b=f-n):b=d;r(a,0)&&r(b,0)||t(this.a,this.a,[a,b])}}B(a){this.a=a;this.F();null!=this.o&&this.w&&this.o();null!=this.s&&this.s()}f(a){let b=[0,0];A(b,a,this.a);return b}h(a){let b=[0,0],c=y();var d=this.a,e=d[0],f=d[1],h=d[2],n=d[3],m=d[4];d=d[5];var p=e*n-f*h;p&&(p=1/p,c[0]=n*p,c[1]=-f*p,c[2]=-h*p,c[3]=e*p,c[4]=(h*d-n*m)*p,c[5]=(f*m-e*d)*p);A(b,a,c);return b}scale(a,b,c){.2>this.a[0]*c?c=.2/this.a[0]:8<this.a[0]*c&&(c=8/this.a[0]);let [d,e]=this.h([a,b]);t(this.a,
this.a,[d,e]);z(this.a,this.a,[c,c]);t(this.a,this.a,[-d,-e]);this.B(this.a)}I(a,b,c){let d=this.viewport.width,e=this.viewport.height;b=Math.min(d/b,e/c);c=y();t(c,c,[d/2,e/2]);z(c,c,[b,b]);t(c,c,[-a[0],-a[1]]);return c}H(a,b,c,d,e,f){c*=e;d*=f;this.B(this.I([a*e+c/2,b*f+d/2],c,d))}}class K{constructor(a,b,c,d,e){this.element=a;this.g=b;this.b=d;this.transform=e;this.u=1;this.C();this.j=c[0];this.i=c[1];this.transform.b=[[this.b.width,this.b.height],[this.j,this.i]];this.l=!1;this.G=[[["scroll"],
()=>this.scroll()],[["wheel"],f=>this.S(f)],[["gesturestart"],()=>this.K()],[["gesturechange"],f=>this.J(f)],[["touchstart"],f=>this.O(f)],[["touchmove"],f=>this.N(f)],[["touchend"],f=>this.M(f)]];this.L=x((f,h,n,m)=>{this.c={left:n,top:m,width:f,height:h};r(f,this.g.offsetWidth)&&r(h,this.g.offsetHeight)||(this.g.style.width=`${f}px`,this.g.style.height=`${h}px`);r(n,this.element.scrollLeft)&&r(m,this.c.scrollTop)||(this.l=!0,this.element.scrollLeft=n,this.l=!0,this.element.scrollTop=m)});this.transform.o=
()=>this.P();this.G.forEach(f=>{f[0].forEach(h=>{this.element.addEventListener(h,f[1],{passive:!1})})});this.D()}P(){let a=this.transform.f([0,0]),b=this.transform.f([this.j,this.i]);this.L(b[0]-a[0],b[1]-a[1],-a[0],-a[1])}scroll(){this.l?this.l=!1:(this.C(),this.D())}D(){let a=this.c.top/this.c.height,b=this.b.height/this.c.height,c=this.c.left/this.c.width,d=this.b.width/this.c.width;1<d&&(c-=(d-1)/2);this.transform.w=!1;this.transform.H(c,a,d,b,this.j,this.i);this.transform.w=!0}S(a){if(a.ctrlKey&&
!this.m()){a.preventDefault();let {x:d,y:e}=B(a,this.element);var b=a.detail;a=15*-a.deltaY||a.wheelDelta||a.wheelDeltaY;var c;b=b?a&&(c=a/b)?b/c:-b/1.35:a/120;b=1>b?-1>b?(-Math.pow(b,2)-224)/225:b:(Math.pow(b,2)+224)/225;b=Math.min(Math.max(b/2,-1),1);0!=b&&(c=this.transform.f([0,0]),this.transform.f([this.j,this.i])[0]-c[0]<this.b.width&&(d=this.b.width/2),this.transform.scale(d,e,Math.exp(.15*b)))}}K(){this.u=1}J(a){if(!this.m()){var b=a.scale/this.u,{x:c,y:d}=B(a,this.element);this.transform.scale(c,
d,b);this.u=a.scale}}m(){return null!=window.visualViewport&&1<window.visualViewport.scale}O(a){2<=a.touches.length&&!this.m()&&(a.stopImmediatePropagation(),a.preventDefault())}N(a){2<=a.touches.length&&!this.m()&&(a.stopImmediatePropagation(),a.preventDefault())}M(a){0==a.touches.length&&1==a.changedTouches.length&&a.preventDefault()}C(){this.c={left:this.element.scrollLeft,top:this.element.scrollTop,width:this.g.scrollWidth,height:this.g.scrollHeight}}}return function(a,b={}){let c=new I(a),d=
0,e=(b.components||[]).map(l=>({...l,id:d++})),f={},h=b.width||500,n=b.height||500,m=document.createElement("div");m.style.width=`${h}px`;m.style.height=`${n}px`;m.style.position="relative";m.style.margin="0 auto";a.appendChild(m);let p=new J(c,()=>{for(var l=0;l<e.length;l++){var g=e[l],k=p.f([0,0]),q=p.f([g.x,g.y]);const C=p.f([g.x+g.width,g.y+g.height]);k={x:q[0]-k[0],y:q[1]-k[1],width:C[0]-q[0],height:C[1]-q[1]};null==f[g.id]?(k=g.component.render(k),f[g.id]=k,a.children[0].appendChild(k)):g.component.update(f[g.id],
k)}l=b.debugCanvas;g=b.width;k=b.height;if(null!=l)for(l=l.getContext("2d"),l.clearRect(-g/.5,-k/.5,g/.5*2,k/.5*2),l.restore(),l.save(),l.scale(.5,.5),l.translate(.5*g,.5*k),g=p.h([0,0]),k=p.h([c.width,c.height]),l.strokeRect(g[0],g[1],k[0]-g[0],k[1]-g[1]),l.fillStyle="rgba(0, 0, 0, 0.02)",l.strokeRect(g[0],g[1],k[0]-g[0],k[1]-g[1]),g=0;g<e.length;g++)q=e[g],k=[q.x,q.y],q=[q.x+q.width,q.y+q.height],l.fillStyle="rgba(0, 0, 0, 0.08)",l.fillRect(k[0],k[1],q[0]-k[0],q[1]-k[1])});p.s();new K(a,m,[h,n],
c,p);c.v=l=>p.R(l)}}"object"===typeof exports&&"undefined"!==typeof module?module.exports=w():"function"===typeof define&&define.T?define(w):(v=v||self,v.scrollzoom=w())
